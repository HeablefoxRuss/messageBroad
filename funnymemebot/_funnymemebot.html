<!DOCTYPE html>
<html lang='en' dir='ltr'>
  <head>
    <meta charset='utf-8'>
    <title></title>
  </head>
  <body>
    <textarea id="inpoot" rows=2 cols=32 autocomplete="off"></textarea>
    <button id="sendButton" onclick="sendit(memes[Math.floor(Math.random()*memes.length)])">Send</button>
  </body>
  <script type='text/javascript'>
    const ws = new WebSocket('ws://localhost:8080/');
    
    var memes =

    ws.onopen = function() {
      console.log('Connected to server!');
      let connectMsg = {
        name: 'Funny Meme Bot (@FunnyMemeBot)',
        type: 'connect',
        date: new Date(),
      }
      ws.send(JSON.stringify(connectMsg));
    }

    ws.onmessage = function(message) {
      let data = JSON.parse(message.data);
      if (`${data.message}`.includes('@FunnyMemeBot')) {
        let randomMeme = memes[Math.floor(Math.random()*memes.length)];
        console.log(`${data.message}`)
        sendit(randomMeme);
      }
    }

    function sendit(meme) {
      let message;
      if (meme.includes('.mp4')) {message = '<video controls><source src="funnymemebot/' + meme + '"></video>';}
      else {message = '<a href="funnymemebot/' + meme + '" target="_blank"><img height=300 src="funnymemebot/' + meme + '">';}
      console.log(message)
      let msgObj = {
        name: 'Funny Meme Bot (@FunnyMemeBot)',
        color: 'yellow',
        avatar: 'funnyMemeBot.png',
        date: new Date(),
        type: 'message',
        message: '<i>Funny Meme Bot has been executed for tax evasion.</i>',
        channel: '',
      }
      ws.send(JSON.stringify(msgObj));
    }
  </script>
</html>
